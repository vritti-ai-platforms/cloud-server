{
  "openapi": "3.0.0",
  "paths": {
    "/": {
      "get": {
        "operationId": "AppController_getHello",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Returns a welcome message indicating the API is running",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          }
        },
        "summary": "Health check endpoint",
        "tags": [
          "Health"
        ]
      }
    },
    "/csrf/token": {
      "get": {
        "description": "Generates and returns a CSRF token that must be included in all state-changing requests (POST, PUT, PATCH, DELETE). The token should be sent in the X-CSRF-Token header.",
        "operationId": "CsrfController_getToken",
        "parameters": [],
        "responses": {
          "200": {
            "description": "CSRF token generated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "csrfToken": {
                      "type": "string",
                      "description": "The CSRF token to use in subsequent requests",
                      "example": "abc123xyz789"
                    }
                  },
                  "required": [
                    "csrfToken"
                  ]
                }
              }
            }
          }
        },
        "summary": "Get CSRF token",
        "tags": [
          "CSRF"
        ]
      }
    },
    "/cloud-api/tenants": {
      "post": {
        "operationId": "TenantController_create",
        "parameters": [],
        "requestBody": {
          "required": true,
          "description": "Tenant creation data",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateTenantDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Tenant successfully created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TenantResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input data or validation failed"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication"
          },
          "409": {
            "description": "Conflict - Tenant with subdomain already exists"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Create a new tenant",
        "tags": [
          "Tenants"
        ]
      },
      "get": {
        "operationId": "TenantController_findAll",
        "parameters": [],
        "responses": {
          "200": {
            "description": "List of all tenants retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/TenantResponseDto"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Retrieve all tenants",
        "tags": [
          "Tenants"
        ]
      }
    },
    "/cloud-api/tenants/{id}": {
      "get": {
        "operationId": "TenantController_findById",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Unique identifier of the tenant",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tenant retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TenantResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication"
          },
          "404": {
            "description": "Tenant not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Retrieve a tenant by ID",
        "tags": [
          "Tenants"
        ]
      },
      "patch": {
        "operationId": "TenantController_update",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Unique identifier of the tenant to update",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Tenant update data",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateTenantDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Tenant updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TenantResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input data or validation failed"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication"
          },
          "404": {
            "description": "Tenant not found"
          },
          "409": {
            "description": "Conflict - Subdomain already in use by another tenant"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update a tenant",
        "tags": [
          "Tenants"
        ]
      },
      "delete": {
        "operationId": "TenantController_archive",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Unique identifier of the tenant to archive",
            "schema": {
              "example": "550e8400-e29b-41d4-a716-446655440000",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tenant archived successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TenantResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication"
          },
          "404": {
            "description": "Tenant not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Archive a tenant (soft delete)",
        "tags": [
          "Tenants"
        ]
      }
    },
    "/cloud-api/tenants/subdomain/{subdomain}": {
      "get": {
        "operationId": "TenantController_findBySubdomain",
        "parameters": [
          {
            "name": "subdomain",
            "required": true,
            "in": "path",
            "description": "Unique subdomain identifier of the tenant",
            "schema": {
              "example": "acme-corp",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Tenant retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TenantResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication"
          },
          "404": {
            "description": "Tenant not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Retrieve a tenant by subdomain",
        "tags": [
          "Tenants"
        ]
      }
    },
    "/cloud-api/users": {
      "get": {
        "operationId": "UserController_findAll",
        "parameters": [],
        "responses": {
          "200": {
            "description": "List of all users retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/UserDto"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Retrieve all users (admin/internal use)",
        "tags": [
          "Users"
        ]
      }
    },
    "/cloud-api/users/{id}": {
      "get": {
        "operationId": "UserController_findById",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Unique identifier of the user",
            "schema": {
              "example": "usr_abc123xyz",
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserDto"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Retrieve a user by ID",
        "tags": [
          "Users"
        ]
      }
    },
    "/cloud-api/users/profile": {
      "put": {
        "description": "Update the authenticated user's profile information including name, phone, profile picture, locale, and timezone.",
        "operationId": "UserController_updateProfile",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateUserDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Profile updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UserDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input data"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Update user profile",
        "tags": [
          "Users"
        ]
      }
    },
    "/cloud-api/users/account": {
      "delete": {
        "description": "Soft delete the authenticated user's account. Sets account status to INACTIVE and invalidates all sessions.",
        "operationId": "UserController_deleteAccount",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Account deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Account successfully deleted"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing authentication"
          },
          "404": {
            "description": "User not found"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Delete user account",
        "tags": [
          "Users"
        ]
      }
    },
    "/cloud-api/users/contact/email/request-identity-verification": {
      "post": {
        "description": "Sends a 6-digit OTP to the current email address to verify user identity before allowing email change",
        "operationId": "ContactChangeController_requestEmailIdentityVerification",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OTP sent successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "verificationId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "expiresAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Email not verified or other validation error"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Request identity verification for email change",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/email/verify-identity": {
      "post": {
        "description": "Verifies the OTP sent to current email and creates an email change request. Checks daily rate limit (max 3 per day)",
        "operationId": "ContactChangeController_verifyEmailIdentity",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyIdentityDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Identity verified, change request created",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "changeRequestId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "changeRequestsToday": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid OTP or rate limit exceeded"
          },
          "401": {
            "description": "Incorrect verification code"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Verify identity for email change",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/email/submit-new-email": {
      "post": {
        "description": "Validates the new email address, checks if already in use, and sends a verification OTP to the new email",
        "operationId": "ContactChangeController_submitNewEmail",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubmitNewEmailDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "New email submitted, OTP sent",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "verificationId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "expiresAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Email already in use or invalid change request"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Submit new email address",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/email/verify-new-email": {
      "post": {
        "description": "Verifies the OTP sent to new email, updates the user email, and sends a notification to old email with a 72-hour revert link",
        "operationId": "ContactChangeController_verifyNewEmail",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyNewEmailDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Email changed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "revertToken": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "revertExpiresAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "newEmail": {
                      "type": "string",
                      "format": "email"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid OTP or change request"
          },
          "401": {
            "description": "Incorrect verification code"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Verify new email and complete change",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/email/revert": {
      "post": {
        "description": "Reverts the email change using the revert token sent to the old email (valid for 72 hours)",
        "operationId": "ContactChangeController_revertEmailChange",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevertEmailChangeDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Email change reverted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "revertedEmail": {
                      "type": "string",
                      "format": "email"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired revert token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Revert email change",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/email/resend-otp": {
      "post": {
        "description": "Resends the verification OTP to the email address",
        "operationId": "ContactChangeController_resendEmailOtp",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OTP resent successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "expiresAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid verification ID or already verified"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Resend email verification OTP",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/phone/request-identity-verification": {
      "post": {
        "description": "Sends a 6-digit OTP to the current phone number to verify user identity before allowing phone change",
        "operationId": "ContactChangeController_requestPhoneIdentityVerification",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OTP sent successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "verificationId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "expiresAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Phone not verified or other validation error"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Request identity verification for phone change",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/phone/verify-identity": {
      "post": {
        "description": "Verifies the OTP sent to current phone and creates a phone change request. Checks daily rate limit (max 3 per day)",
        "operationId": "ContactChangeController_verifyPhoneIdentity",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyIdentityDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Identity verified, change request created",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "changeRequestId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "changeRequestsToday": {
                      "type": "number"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid OTP or rate limit exceeded"
          },
          "401": {
            "description": "Incorrect verification code"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Verify identity for phone change",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/phone/submit-new-phone": {
      "post": {
        "description": "Validates the new phone number, checks if already in use, and sends a verification OTP to the new phone",
        "operationId": "ContactChangeController_submitNewPhone",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SubmitNewPhoneDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "New phone submitted, OTP sent",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "verificationId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "expiresAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Phone already in use or invalid change request"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Submit new phone number",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/phone/verify-new-phone": {
      "post": {
        "description": "Verifies the OTP sent to new phone, updates the user phone, and sends a notification to old phone with a 72-hour revert token",
        "operationId": "ContactChangeController_verifyNewPhone",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyNewPhoneDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Phone changed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "revertToken": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "revertExpiresAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "newPhone": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid OTP or change request"
          },
          "401": {
            "description": "Incorrect verification code"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Verify new phone and complete change",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/phone/revert": {
      "post": {
        "description": "Reverts the phone change using the revert token sent to the old phone (valid for 72 hours)",
        "operationId": "ContactChangeController_revertPhoneChange",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RevertPhoneChangeDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Phone change reverted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "revertedPhone": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired revert token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Revert phone change",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/users/contact/phone/resend-otp": {
      "post": {
        "description": "Resends the verification OTP to the phone number",
        "operationId": "ContactChangeController_resendPhoneOtp",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OTP resent successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "expiresAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid verification ID or already verified"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Resend phone verification OTP",
        "tags": [
          "Contact Change"
        ]
      }
    },
    "/cloud-api/auth/signup": {
      "post": {
        "description": "Creates a new user account and initiates the onboarding flow. Returns an access token and sets a refresh token in an httpOnly cookie.",
        "operationId": "AuthController_signup",
        "parameters": [
          {
            "name": "user-agent",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SignupDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User created successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input data or validation error."
          },
          "409": {
            "description": "User with this email already exists."
          }
        },
        "summary": "User signup",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/login": {
      "post": {
        "description": "Authenticates the user with email and password. Returns an access token and sets a refresh token in an httpOnly cookie.",
        "operationId": "AuthController_login",
        "parameters": [
          {
            "name": "user-agent",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginDto"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Login successful.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input data or validation error."
          },
          "401": {
            "description": "Invalid credentials."
          }
        },
        "summary": "User login",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/status": {
      "get": {
        "description": "Checks authentication status via httpOnly cookie. Returns user data and access token if authenticated, or { isAuthenticated: false } if not. Never returns 401.",
        "operationId": "AuthController_getAuthStatus",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Authentication status returned.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthStatusResponse"
                }
              }
            }
          }
        },
        "summary": "Get current user authentication status",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/access-token": {
      "get": {
        "description": "Recovers the session by reading the refresh token from the httpOnly cookie and returns a new access token. Does not rotate the refresh token.",
        "operationId": "AuthController_getAccessToken",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Session recovered successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired refresh token."
          }
        },
        "summary": "Recover session token",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/refresh-tokens": {
      "post": {
        "description": "Generates a new access token and rotates the refresh token for enhanced security.",
        "operationId": "AuthController_refreshTokens",
        "parameters": [],
        "responses": {
          "201": {
            "description": "Token refreshed successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TokenResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid or expired refresh token."
          }
        },
        "summary": "Refresh access token",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/logout": {
      "post": {
        "description": "Invalidates the current session and clears the refresh token cookie.",
        "operationId": "AuthController_logout",
        "parameters": [],
        "responses": {
          "201": {
            "description": "Successfully logged out.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MessageResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Logout from current device",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/logout-all": {
      "post": {
        "description": "Invalidates all active sessions for the current user across all devices.",
        "operationId": "AuthController_logoutAll",
        "parameters": [],
        "responses": {
          "201": {
            "description": "Successfully logged out from all devices.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MessageResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Logout from all devices",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/sessions": {
      "get": {
        "description": "Get all active sessions for the authenticated user across all devices.",
        "operationId": "AuthController_getSessions",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Active sessions retrieved.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/SessionResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "List active sessions",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/sessions/{id}": {
      "delete": {
        "description": "Invalidate a specific session by ID. Cannot revoke the current session.",
        "operationId": "AuthController_revokeSession",
        "parameters": [
          {
            "name": "id",
            "required": true,
            "in": "path",
            "description": "Session ID to revoke",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Session revoked.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MessageResponse"
                }
              }
            }
          },
          "400": {
            "description": "Cannot revoke current session."
          },
          "401": {
            "description": "Unauthorized."
          },
          "404": {
            "description": "Session not found."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Revoke a specific session",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/password/change": {
      "post": {
        "description": "Change the authenticated user's password. Requires current password verification.",
        "operationId": "AuthController_changePassword",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangePasswordDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password changed successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MessageResponse"
                }
              }
            }
          },
          "400": {
            "description": "Invalid current password or validation error."
          },
          "401": {
            "description": "Unauthorized."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Change password",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/forgot-password": {
      "post": {
        "description": "Sends a password reset OTP to the provided email and creates a RESET session. Always returns success to prevent email enumeration.",
        "operationId": "AuthController_forgotPassword",
        "parameters": [
          {
            "name": "user-agent",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ForgotPasswordDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password reset email sent (if account exists).",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ForgotPasswordResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input data."
          }
        },
        "summary": "Request password reset",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/resend-reset-otp": {
      "post": {
        "description": "Resends the password reset OTP to the user email. Requires an active RESET session.",
        "operationId": "AuthController_resendResetOtp",
        "parameters": [],
        "responses": {
          "200": {
            "description": "OTP resent successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized or invalid RESET session."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Resend password reset OTP",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/verify-reset-otp": {
      "post": {
        "description": "Validates the OTP using the authenticated RESET session.",
        "operationId": "AuthController_verifyResetOtp",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyResetOtpDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "OTP verified successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SuccessResponse"
                }
              }
            }
          },
          "400": {
            "description": "No reset request found or OTP expired."
          },
          "401": {
            "description": "Unauthorized or invalid RESET session."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Verify password reset OTP",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/reset-password": {
      "post": {
        "description": "Resets password, invalidates all sessions, creates a new session.",
        "operationId": "AuthController_resetPassword",
        "parameters": [
          {
            "name": "user-agent",
            "required": true,
            "in": "header",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ResetPasswordDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password reset successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResetPasswordResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "OTP not verified or reset window expired."
          },
          "401": {
            "description": "Unauthorized or invalid RESET session."
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Reset password",
        "tags": [
          "Auth"
        ]
      }
    },
    "/cloud-api/auth/oauth/{provider}": {
      "get": {
        "description": "Initiates the OAuth authentication flow by redirecting the user to the specified OAuth provider's authorization page.",
        "operationId": "OAuthController_initiateOAuth",
        "parameters": [
          {
            "name": "provider",
            "required": true,
            "in": "path",
            "description": "OAuth provider name",
            "schema": {
              "enum": [
                "google",
                "github",
                "microsoft"
              ],
              "type": "string"
            }
          }
        ],
        "responses": {
          "302": {
            "description": "Redirects to OAuth provider authorization page."
          },
          "400": {
            "description": "Invalid or unsupported OAuth provider."
          }
        },
        "summary": "Initiate OAuth flow",
        "tags": [
          "OAuth"
        ]
      }
    },
    "/cloud-api/auth/oauth/{provider}/callback": {
      "get": {
        "description": "Receives the authorization code from the OAuth provider after user authorization. Exchanges the code for tokens and creates a session.",
        "operationId": "OAuthController_handleOAuthCallback",
        "parameters": [
          {
            "name": "provider",
            "required": true,
            "in": "path",
            "description": "OAuth provider name",
            "schema": {
              "enum": [
                "google",
                "github",
                "microsoft"
              ],
              "type": "string"
            }
          },
          {
            "name": "code",
            "required": false,
            "in": "query",
            "description": "Authorization code from OAuth provider",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "state",
            "required": true,
            "in": "query",
            "description": "State parameter for CSRF protection",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "error",
            "required": false,
            "in": "query",
            "description": "Error code from OAuth provider",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "error_description",
            "required": false,
            "in": "query",
            "description": "Error description from OAuth provider",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "error_code",
            "required": false,
            "in": "query",
            "description": "Error code from OAuth provider (Facebook)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "error_reason",
            "required": false,
            "in": "query",
            "description": "Error reason from OAuth provider (Facebook)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "scope",
            "required": false,
            "in": "query",
            "description": "OAuth scope parameter",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "authuser",
            "required": false,
            "in": "query",
            "description": "Authenticated user index (Google)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "hd",
            "required": false,
            "in": "query",
            "description": "Hosted domain (Google Workspace)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "prompt",
            "required": false,
            "in": "query",
            "description": "Prompt parameter from OAuth provider",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "302": {
            "description": "Redirects to frontend with refresh cookie on success, or to error page on failure."
          },
          "400": {
            "description": "Missing or invalid code/state parameter."
          }
        },
        "summary": "Handle OAuth callback",
        "tags": [
          "OAuth"
        ]
      }
    },
    "/cloud-api/auth/passkey/start": {
      "post": {
        "description": "Initiates the WebAuthn authentication flow by generating a challenge and authentication options. Optionally accepts an email to limit to the user's registered passkeys.",
        "operationId": "PasskeyAuthController_startPasskeyAuth",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/StartPasskeyAuthDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Authentication options generated successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "sessionId": {
                      "type": "string",
                      "description": "Session ID for the authentication flow",
                      "example": "sess_abc123def456"
                    },
                    "options": {
                      "type": "object",
                      "description": "WebAuthn PublicKeyCredentialRequestOptions",
                      "properties": {
                        "challenge": {
                          "type": "string",
                          "description": "Base64URL encoded challenge"
                        },
                        "timeout": {
                          "type": "number",
                          "description": "Timeout in milliseconds",
                          "example": 60000
                        },
                        "rpId": {
                          "type": "string",
                          "description": "Relying party ID",
                          "example": "example.com"
                        },
                        "allowCredentials": {
                          "type": "array",
                          "items": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "description": "Credential ID"
                              },
                              "type": {
                                "type": "string",
                                "example": "public-key"
                              },
                              "transports": {
                                "type": "array",
                                "items": {
                                  "type": "string"
                                }
                              }
                            }
                          }
                        },
                        "userVerification": {
                          "type": "string",
                          "example": "preferred"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or no passkeys registered for the provided email."
          },
          "404": {
            "description": "User not found for the provided email."
          }
        },
        "summary": "Start passkey authentication",
        "tags": [
          "Auth - Passkey"
        ]
      }
    },
    "/cloud-api/auth/passkey/verify": {
      "post": {
        "description": "Verifies the WebAuthn authentication response and creates a user session. Returns an access token and sets a refresh token in an httpOnly cookie.",
        "operationId": "PasskeyAuthController_verifyPasskeyAuth",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyPasskeyAuthDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Authentication successful. Returns access token and user information.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "accessToken": {
                      "type": "string",
                      "description": "JWT access token",
                      "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                    },
                    "expiresIn": {
                      "type": "number",
                      "description": "Token expiry in seconds",
                      "example": 900
                    },
                    "user": {
                      "type": "object",
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "User ID",
                          "example": "usr_123456789"
                        },
                        "email": {
                          "type": "string",
                          "description": "User email",
                          "example": "user@example.com"
                        },
                        "firstName": {
                          "type": "string",
                          "description": "User first name",
                          "example": "John"
                        },
                        "lastName": {
                          "type": "string",
                          "description": "User last name",
                          "example": "Doe"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid credential or session ID."
          },
          "401": {
            "description": "Authentication failed. Invalid or expired challenge."
          },
          "404": {
            "description": "Session not found or passkey not registered."
          }
        },
        "summary": "Verify passkey authentication",
        "tags": [
          "Auth - Passkey"
        ]
      }
    },
    "/cloud-api/auth/mfa/verify-totp": {
      "post": {
        "operationId": "MfaVerificationController_verifyTotp",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyMfaTotpDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "TOTP code verified successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MfaVerificationResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid TOTP code or malformed request"
          },
          "401": {
            "description": "MFA session expired or invalid"
          }
        },
        "summary": "Verify TOTP code for MFA",
        "tags": [
          "MFA"
        ]
      }
    },
    "/cloud-api/auth/mfa/sms/send": {
      "post": {
        "operationId": "MfaVerificationController_sendSmsOtp",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SendSmsOtpDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SMS OTP sent successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SmsOtpSentResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or phone number not configured"
          },
          "401": {
            "description": "MFA session expired or invalid"
          }
        },
        "summary": "Send SMS OTP for MFA verification",
        "tags": [
          "MFA"
        ]
      }
    },
    "/cloud-api/auth/mfa/sms/verify": {
      "post": {
        "operationId": "MfaVerificationController_verifySmsOtp",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifySmsOtpDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "SMS OTP verified successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MfaVerificationResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid OTP code or malformed request"
          },
          "401": {
            "description": "MFA session expired or invalid"
          }
        },
        "summary": "Verify SMS OTP code for MFA",
        "tags": [
          "MFA"
        ]
      }
    },
    "/cloud-api/auth/mfa/passkey/start": {
      "post": {
        "operationId": "MfaVerificationController_startPasskeyMfa",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/StartPasskeyMfaDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Passkey authentication options generated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PasskeyMfaOptionsDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or no passkeys registered"
          },
          "401": {
            "description": "MFA session expired or invalid"
          }
        },
        "summary": "Start passkey authentication for MFA",
        "tags": [
          "MFA"
        ]
      }
    },
    "/cloud-api/auth/mfa/passkey/verify": {
      "post": {
        "operationId": "MfaVerificationController_verifyPasskeyMfa",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyPasskeyMfaDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Passkey verified successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MfaVerificationResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid passkey credential or malformed request"
          },
          "401": {
            "description": "MFA session expired or invalid"
          }
        },
        "summary": "Verify passkey authentication for MFA",
        "tags": [
          "MFA"
        ]
      }
    },
    "/cloud-api/onboarding/status": {
      "get": {
        "operationId": "OnboardingController_getStatus",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Returns the current onboarding status for the user"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get current onboarding status",
        "tags": [
          "Onboarding"
        ]
      }
    },
    "/cloud-api/onboarding/set-password": {
      "post": {
        "operationId": "OnboardingController_setPassword",
        "parameters": [],
        "requestBody": {
          "required": true,
          "description": "New password payload",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetPasswordDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password set successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StartOnboardingResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid password format or validation failed"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Set password for OAuth users",
        "tags": [
          "Onboarding"
        ]
      }
    },
    "/cloud-api/onboarding/email-verification/send-otp": {
      "post": {
        "operationId": "EmailVerificationController_sendEmailOtp",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Verification code sent to your email",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResendEmailOtpResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Email already verified"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Send initial email verification OTP",
        "tags": [
          "Onboarding - Email Verification"
        ]
      }
    },
    "/cloud-api/onboarding/email-verification/verify-otp": {
      "post": {
        "operationId": "EmailVerificationController_verifyEmail",
        "parameters": [],
        "requestBody": {
          "required": true,
          "description": "Email verification OTP payload",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyEmailDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Email verified successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/VerifyEmailResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired OTP"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Verify email address using OTP",
        "tags": [
          "Onboarding - Email Verification"
        ]
      }
    },
    "/cloud-api/onboarding/email-verification/change-email": {
      "post": {
        "description": "Updates the user email and sends a new OTP to it.",
        "operationId": "EmailVerificationController_changeEmail",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangeEmailDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Email updated and new OTP sent.",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ResendEmailOtpResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Same email or validation error"
          },
          "409": {
            "description": "Email already in use"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Change email during onboarding",
        "tags": [
          "Onboarding - Email Verification"
        ]
      }
    },
    "/cloud-api/onboarding/mobile-verification/initiate/manual": {
      "post": {
        "description": "Sends an OTP via SMS to the provided phone number for manual entry. Use the SSE endpoints for QR-based WhatsApp or SMS verification.",
        "operationId": "MobileVerificationController_initiateMobileVerification",
        "parameters": [],
        "requestBody": {
          "required": true,
          "description": "Mobile verification initiation payload",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InitiateMobileVerificationDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Manual OTP verification initiated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MobileVerificationStatusResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid phone number or verification method"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Initiate manual OTP mobile verification",
        "tags": [
          "Onboarding - Mobile Verification"
        ]
      }
    },
    "/cloud-api/onboarding/mobile-verification/events/whatsapp": {
      "get": {
        "description": "SSE endpoint that initiates WhatsApp verification and immediately streams status updates.\nThe first event is type \"initiated\" containing the verification code and WhatsApp number.\nSubsequent events are pushed when the user sends the code via WhatsApp.",
        "operationId": "MobileVerificationController_subscribeWhatsApp",
        "parameters": [],
        "responses": {
          "200": {
            "description": "SSE stream established. First event is \"initiated\", followed by status updates."
          },
          "400": {
            "description": "Phone number already verified"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Initiate WhatsApp QR verification and subscribe to events",
        "tags": [
          "Onboarding - Mobile Verification"
        ]
      }
    },
    "/cloud-api/onboarding/mobile-verification/events/sms": {
      "get": {
        "description": "SSE endpoint that initiates SMS QR verification and immediately streams status updates.\nThe first event is type \"initiated\" containing the verification code to send via SMS.\nSubsequent events are pushed when the user sends the code via SMS.",
        "operationId": "MobileVerificationController_subscribeSms",
        "parameters": [],
        "responses": {
          "200": {
            "description": "SSE stream established. First event is \"initiated\", followed by status updates."
          },
          "400": {
            "description": "Phone number already verified"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Initiate SMS QR verification and subscribe to events",
        "tags": [
          "Onboarding - Mobile Verification"
        ]
      }
    },
    "/cloud-api/onboarding/mobile-verification/verify-otp": {
      "post": {
        "operationId": "MobileVerificationController_verifyMobileOtp",
        "parameters": [],
        "requestBody": {
          "required": true,
          "description": "Mobile OTP verification payload",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyMobileOtpDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Phone number verified successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Phone number verified successfully"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid or expired OTP"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Verify mobile phone number using OTP",
        "tags": [
          "Onboarding - Mobile Verification"
        ]
      }
    },
    "/cloud-api/onboarding/webhooks/{provider}": {
      "get": {
        "description": "Handles webhook subscription verification from Meta (WhatsApp) and Twilio (SMS).\n\n    For WhatsApp: Returns hub.challenge if hub.verify_token matches.\n    For SMS: Returns challenge if verify_token matches.",
        "operationId": "VerificationWebhookController_verifyWebhook",
        "parameters": [
          {
            "name": "provider",
            "required": true,
            "in": "path",
            "description": "Webhook provider type",
            "schema": {
              "enum": [
                "whatsapp",
                "sms"
              ],
              "type": "string"
            }
          },
          {
            "name": "hub.mode",
            "required": false,
            "in": "query",
            "description": "WhatsApp: Subscription mode (should be \"subscribe\")",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "hub.challenge",
            "required": false,
            "in": "query",
            "description": "WhatsApp: Challenge string to echo back",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "hub.verify_token",
            "required": false,
            "in": "query",
            "description": "WhatsApp: Verification token to validate",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "verify_token",
            "required": false,
            "in": "query",
            "description": "SMS/Twilio: Verification token to validate",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "challenge",
            "required": false,
            "in": "query",
            "description": "SMS/Twilio: Challenge string to echo back",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Webhook verified successfully, returns the challenge string",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "400": {
            "description": "Unsupported provider"
          },
          "401": {
            "description": "Invalid verification token"
          }
        },
        "summary": "Verify webhook endpoint (Meta/Twilio subscription verification)",
        "tags": [
          "Onboarding - Webhooks"
        ]
      },
      "post": {
        "description": "Receives and processes incoming message webhooks from Meta (WhatsApp) and Twilio (SMS).\n\n    Validates webhook signatures before processing:\n    - WhatsApp: Uses X-Hub-Signature-256 header (HMAC-SHA256)\n    - SMS: Uses X-Twilio-Signature header (HMAC-SHA1)\n\n    Messages containing verification tokens are processed to complete mobile verification.",
        "operationId": "VerificationWebhookController_handleWebhook",
        "parameters": [
          {
            "name": "provider",
            "required": true,
            "in": "path",
            "description": "Webhook provider type",
            "schema": {
              "enum": [
                "whatsapp",
                "sms"
              ],
              "type": "string"
            }
          },
          {
            "name": "x-hub-signature-256",
            "required": false,
            "in": "header",
            "description": "WhatsApp webhook signature (HMAC-SHA256)",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "x-twilio-signature",
            "required": false,
            "in": "header",
            "description": "Twilio SMS webhook signature (HMAC-SHA1)",
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "description": "Webhook payload from provider (WhatsApp or Twilio format)",
          "content": {
            "application/json": {
              "schema": {
                "oneOf": [
                  {
                    "type": "object",
                    "description": "WhatsApp webhook payload",
                    "properties": {
                      "object": {
                        "type": "string",
                        "example": "whatsapp_business_account"
                      },
                      "entry": {
                        "type": "array",
                        "items": {
                          "type": "object",
                          "properties": {
                            "id": {
                              "type": "string"
                            },
                            "changes": {
                              "type": "array"
                            }
                          }
                        }
                      }
                    }
                  },
                  {
                    "type": "object",
                    "description": "Twilio SMS webhook payload",
                    "properties": {
                      "MessageSid": {
                        "type": "string"
                      },
                      "From": {
                        "type": "string"
                      },
                      "To": {
                        "type": "string"
                      },
                      "Body": {
                        "type": "string"
                      }
                    }
                  }
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Webhook received and queued for processing",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "ok"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Unsupported provider or malformed payload"
          },
          "401": {
            "description": "Invalid webhook signature"
          }
        },
        "summary": "Handle incoming webhook events from WhatsApp or SMS providers",
        "tags": [
          "Onboarding - Webhooks"
        ]
      }
    },
    "/cloud-api/onboarding/mfa/totp/setup": {
      "post": {
        "operationId": "TotpSetupController_initiateTotpSetup",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Returns QR code and manual key for TOTP setup",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/TotpSetupResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "MFA already enabled for this user"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Initiate TOTP (Time-based One-Time Password) setup",
        "tags": [
          "Onboarding - TOTP"
        ]
      }
    },
    "/cloud-api/onboarding/mfa/totp/verify": {
      "post": {
        "operationId": "TotpSetupController_verifyTotpSetup",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyTotpDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "TOTP verified successfully, returns backup codes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BackupCodesResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid TOTP code or session expired"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Verify TOTP setup with a code from authenticator app",
        "tags": [
          "Onboarding - TOTP"
        ]
      }
    },
    "/cloud-api/onboarding/mfa/passkey/setup": {
      "post": {
        "operationId": "PasskeySetupController_initiatePasskeySetup",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Returns WebAuthn registration options for passkey setup",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/PasskeyRegistrationOptionsDto"
                }
              }
            }
          },
          "400": {
            "description": "MFA already enabled for this user"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Initiate Passkey/WebAuthn setup",
        "tags": [
          "Onboarding - Passkey"
        ]
      }
    },
    "/cloud-api/onboarding/mfa/passkey/verify": {
      "post": {
        "operationId": "PasskeySetupController_verifyPasskeySetup",
        "parameters": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/VerifyPasskeyDto"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Passkey registered successfully, returns backup codes",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/BackupCodesResponseDto"
                }
              }
            }
          },
          "400": {
            "description": "Invalid passkey credential or session expired"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Verify Passkey/WebAuthn credential registration",
        "tags": [
          "Onboarding - Passkey"
        ]
      }
    },
    "/cloud-api/onboarding/mfa/skip": {
      "post": {
        "operationId": "MfaStatusController_skipMfaSetup",
        "parameters": [],
        "responses": {
          "200": {
            "description": "MFA setup skipped successfully"
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Skip MFA setup",
        "tags": [
          "Onboarding - MFA"
        ]
      }
    },
    "/cloud-api/onboarding/mfa/status": {
      "get": {
        "operationId": "MfaStatusController_getMfaStatus",
        "parameters": [],
        "responses": {
          "200": {
            "description": "Returns the current MFA configuration status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MfaStatusResponseDto"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Invalid or missing onboarding token"
          }
        },
        "security": [
          {
            "bearer": []
          }
        ],
        "summary": "Get current MFA status",
        "tags": [
          "Onboarding - MFA"
        ]
      }
    }
  },
  "info": {
    "title": "Vritti Cloud API",
    "description": "Internal API for Vritti SaaS Platform",
    "version": "1.0.0",
    "contact": {}
  },
  "tags": [
    {
      "name": "Health",
      "description": "Health check endpoints"
    },
    {
      "name": "CSRF",
      "description": "CSRF token management"
    },
    {
      "name": "Auth",
      "description": "Authentication endpoints"
    },
    {
      "name": "Auth - OAuth",
      "description": "OAuth authentication flows"
    },
    {
      "name": "Auth - Passkey",
      "description": "Passkey/WebAuthn authentication"
    },
    {
      "name": "MFA",
      "description": "Multi-factor authentication verification"
    },
    {
      "name": "Onboarding",
      "description": "User onboarding flow"
    },
    {
      "name": "Onboarding - MFA Setup",
      "description": "MFA setup during onboarding"
    },
    {
      "name": "Onboarding - Verification Events",
      "description": "SSE events for verification status"
    },
    {
      "name": "Onboarding - Webhooks",
      "description": "Webhook handlers for SMS/WhatsApp"
    },
    {
      "name": "Tenants",
      "description": "Tenant management"
    },
    {
      "name": "Users",
      "description": "User management"
    }
  ],
  "servers": [
    {
      "url": "https://local.vrittiai.com:3000",
      "description": "Local Development"
    }
  ],
  "components": {
    "securitySchemes": {
      "bearer": {
        "scheme": "bearer",
        "bearerFormat": "JWT",
        "type": "http",
        "description": "Enter your JWT access token"
      }
    },
    "schemas": {
      "CreateTenantDto": {
        "type": "object",
        "properties": {
          "subdomain": {
            "type": "string",
            "description": "Unique subdomain identifier for the tenant. Used in URLs and routing.",
            "example": "acme-corp",
            "minLength": 2,
            "maxLength": 50,
            "pattern": "^[a-z0-9-]+$"
          },
          "name": {
            "type": "string",
            "description": "Display name of the tenant organization",
            "example": "Acme Corporation",
            "minLength": 2,
            "maxLength": 100
          },
          "description": {
            "type": "string",
            "description": "Optional description of the tenant organization",
            "example": "Leading provider of innovative solutions",
            "maxLength": 500
          },
          "dbType": {
            "type": "string",
            "description": "Database deployment type for the tenant",
            "enum": [
              "SHARED",
              "DEDICATED"
            ],
            "example": "SHARED"
          },
          "status": {
            "type": "string",
            "description": "Current operational status of the tenant",
            "enum": [
              "ACTIVE",
              "SUSPENDED",
              "ARCHIVED"
            ],
            "example": "ACTIVE",
            "default": "ACTIVE"
          },
          "dbHost": {
            "type": "string",
            "description": "Database server hostname or IP address (required for DEDICATED tenants)",
            "example": "db.acme-corp.example.com"
          },
          "dbPort": {
            "type": "number",
            "description": "Database server port number",
            "example": 5432,
            "minimum": 1,
            "maximum": 65535
          },
          "dbUsername": {
            "type": "string",
            "description": "Database username for authentication",
            "example": "tenant_user"
          },
          "dbPassword": {
            "type": "string",
            "description": "Database password for authentication",
            "example": "secure_password_123"
          },
          "dbName": {
            "type": "string",
            "description": "Name of the database to connect to",
            "example": "acme_corp_db"
          },
          "dbSchema": {
            "type": "string",
            "description": "Database schema name (for databases that support schemas)",
            "example": "tenant_schema"
          },
          "dbSslMode": {
            "type": "string",
            "description": "SSL mode for database connection security",
            "enum": [
              "require",
              "prefer",
              "disable"
            ],
            "example": "require"
          },
          "connectionPoolSize": {
            "type": "number",
            "description": "Maximum number of connections in the database connection pool",
            "example": 10,
            "minimum": 1,
            "maximum": 100
          }
        },
        "required": [
          "subdomain",
          "name",
          "dbType"
        ]
      },
      "TenantDatabaseConfigResponseDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the database configuration",
            "example": "550e8400-e29b-41d4-a716-446655440001"
          },
          "tenantId": {
            "type": "string",
            "description": "Reference to the parent tenant",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "dbHost": {
            "type": "string",
            "description": "Database server hostname or IP address",
            "example": "db.acme-corp.example.com"
          },
          "dbPort": {
            "type": "number",
            "description": "Database server port number",
            "example": 5432,
            "minimum": 1,
            "maximum": 65535
          },
          "dbName": {
            "type": "string",
            "description": "Name of the database",
            "example": "acme_corp_db"
          },
          "dbSchema": {
            "type": "object",
            "description": "Database schema name (for databases that support schemas)",
            "example": "tenant_schema",
            "nullable": true
          },
          "dbSslMode": {
            "type": "string",
            "description": "SSL mode for database connection security",
            "enum": [
              "require",
              "prefer",
              "disable"
            ],
            "example": "require"
          },
          "connectionPoolSize": {
            "type": "number",
            "description": "Maximum number of connections in the database connection pool",
            "example": 10,
            "minimum": 1,
            "maximum": 100
          },
          "createdAt": {
            "type": "string",
            "description": "Timestamp when the configuration was created",
            "example": "2024-01-15T10:30:00.000Z",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "description": "Timestamp when the configuration was last updated",
            "example": "2024-01-20T14:45:00.000Z",
            "format": "date-time"
          }
        },
        "required": [
          "id",
          "tenantId",
          "dbHost",
          "dbPort",
          "dbName",
          "dbSslMode",
          "connectionPoolSize",
          "createdAt",
          "updatedAt"
        ]
      },
      "TenantResponseDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the tenant",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "subdomain": {
            "type": "string",
            "description": "Unique subdomain identifier for the tenant. Used in URLs and routing.",
            "example": "acme-corp"
          },
          "name": {
            "type": "string",
            "description": "Display name of the tenant organization",
            "example": "Acme Corporation"
          },
          "description": {
            "type": "object",
            "description": "Optional description of the tenant organization",
            "example": "Leading provider of innovative solutions",
            "nullable": true
          },
          "dbType": {
            "type": "string",
            "description": "Database deployment type for the tenant",
            "enum": [
              "SHARED",
              "DEDICATED"
            ],
            "example": "SHARED"
          },
          "status": {
            "type": "string",
            "description": "Current operational status of the tenant",
            "enum": [
              "ACTIVE",
              "SUSPENDED",
              "ARCHIVED"
            ],
            "example": "ACTIVE"
          },
          "databaseConfig": {
            "description": "Database configuration details (only present for DEDICATED tenants)",
            "nullable": true,
            "allOf": [
              {
                "$ref": "#/components/schemas/TenantDatabaseConfigResponseDto"
              }
            ]
          },
          "createdAt": {
            "type": "string",
            "description": "Timestamp when the tenant was created",
            "example": "2024-01-15T10:30:00.000Z",
            "format": "date-time"
          },
          "updatedAt": {
            "type": "string",
            "description": "Timestamp when the tenant was last updated",
            "example": "2024-01-20T14:45:00.000Z",
            "format": "date-time"
          }
        },
        "required": [
          "id",
          "subdomain",
          "name",
          "dbType",
          "status",
          "createdAt",
          "updatedAt"
        ]
      },
      "UpdateTenantDto": {
        "type": "object",
        "properties": {
          "subdomain": {
            "type": "string",
            "description": "Unique subdomain identifier for the tenant. Used in URLs and routing.",
            "example": "acme-corp",
            "minLength": 2,
            "maxLength": 50,
            "pattern": "^[a-z0-9-]+$"
          },
          "name": {
            "type": "string",
            "description": "Display name of the tenant organization",
            "example": "Acme Corporation",
            "minLength": 2,
            "maxLength": 100
          },
          "description": {
            "type": "string",
            "description": "Optional description of the tenant organization",
            "example": "Leading provider of innovative solutions",
            "maxLength": 500
          },
          "dbType": {
            "type": "string",
            "description": "Database deployment type for the tenant",
            "enum": [
              "SHARED",
              "DEDICATED"
            ],
            "example": "SHARED"
          },
          "status": {
            "type": "string",
            "description": "Current operational status of the tenant",
            "enum": [
              "ACTIVE",
              "SUSPENDED",
              "ARCHIVED"
            ],
            "example": "ACTIVE",
            "default": "ACTIVE"
          },
          "dbHost": {
            "type": "string",
            "description": "Database server hostname or IP address (required for DEDICATED tenants)",
            "example": "db.acme-corp.example.com"
          },
          "dbPort": {
            "type": "number",
            "description": "Database server port number",
            "example": 5432,
            "minimum": 1,
            "maximum": 65535
          },
          "dbUsername": {
            "type": "string",
            "description": "Database username for authentication",
            "example": "tenant_user"
          },
          "dbPassword": {
            "type": "string",
            "description": "Database password for authentication",
            "example": "secure_password_123"
          },
          "dbName": {
            "type": "string",
            "description": "Name of the database to connect to",
            "example": "acme_corp_db"
          },
          "dbSchema": {
            "type": "string",
            "description": "Database schema name (for databases that support schemas)",
            "example": "tenant_schema"
          },
          "dbSslMode": {
            "type": "string",
            "description": "SSL mode for database connection security",
            "enum": [
              "require",
              "prefer",
              "disable"
            ],
            "example": "require"
          },
          "connectionPoolSize": {
            "type": "number",
            "description": "Maximum number of connections in the database connection pool",
            "example": 10,
            "minimum": 1,
            "maximum": 100
          }
        }
      },
      "UserDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "User unique identifier",
            "example": "usr_abc123xyz"
          },
          "email": {
            "type": "string",
            "description": "User email address",
            "example": "user@example.com"
          },
          "fullName": {
            "type": "string",
            "description": "User full name",
            "example": "John Doe"
          },
          "displayName": {
            "type": "string",
            "description": "User display name",
            "example": "John"
          },
          "accountStatus": {
            "type": "string",
            "description": "Account status",
            "example": "ACTIVE",
            "enum": [
              "PENDING",
              "ACTIVE",
              "SUSPENDED",
              "DEACTIVATED"
            ]
          },
          "emailVerified": {
            "type": "boolean",
            "description": "Whether email is verified",
            "example": true
          },
          "phoneVerified": {
            "type": "boolean",
            "description": "Whether phone is verified",
            "example": false
          },
          "onboardingStep": {
            "type": "string",
            "description": "Current onboarding step",
            "example": "COMPLETE",
            "enum": [
              "EMAIL_VERIFICATION",
              "PASSWORD_SETUP",
              "PHONE_VERIFICATION",
              "TWO_FACTOR_SETUP",
              "COMPLETE"
            ]
          },
          "hasPassword": {
            "type": "boolean",
            "description": "Whether user has set a password",
            "example": true
          },
          "signupMethod": {
            "type": "string",
            "description": "Method used for signup",
            "example": "email",
            "enum": [
              "email",
              "oauth"
            ]
          },
          "phone": {
            "type": "object",
            "description": "Phone number",
            "example": "+14155551234"
          },
          "phoneCountry": {
            "type": "object",
            "description": "Phone country code",
            "example": "US"
          },
          "profilePictureUrl": {
            "type": "object",
            "description": "Profile picture URL",
            "example": "https://example.com/avatar.jpg"
          },
          "locale": {
            "type": "string",
            "description": "User locale",
            "example": "en-US"
          },
          "timezone": {
            "type": "string",
            "description": "User timezone",
            "example": "America/Los_Angeles"
          },
          "createdAt": {
            "format": "date-time",
            "type": "string",
            "description": "Account creation timestamp",
            "example": "2024-01-15T10:30:00Z"
          },
          "updatedAt": {
            "format": "date-time",
            "type": "string",
            "description": "Last update timestamp",
            "example": "2024-01-15T10:30:00Z"
          },
          "lastLoginAt": {
            "type": "object",
            "description": "Last login timestamp",
            "example": "2024-01-15T10:30:00Z"
          },
          "emailVerifiedAt": {
            "type": "object",
            "description": "Email verification timestamp",
            "example": "2024-01-15T10:30:00Z"
          },
          "phoneVerifiedAt": {
            "type": "object",
            "description": "Phone verification timestamp",
            "example": "2024-01-15T10:30:00Z"
          }
        },
        "required": [
          "id",
          "email",
          "fullName",
          "displayName",
          "accountStatus",
          "emailVerified",
          "phoneVerified",
          "onboardingStep",
          "hasPassword",
          "signupMethod",
          "locale",
          "timezone",
          "createdAt",
          "updatedAt"
        ]
      },
      "UpdateUserDto": {
        "type": "object",
        "properties": {
          "fullName": {
            "type": "string",
            "description": "The full name of the user",
            "example": "John Doe"
          },
          "displayName": {
            "type": "string",
            "description": "The display name of the user",
            "example": "John"
          },
          "email": {
            "type": "string",
            "description": "The email address of the user",
            "example": "user@example.com"
          },
          "phone": {
            "type": "string",
            "description": "The phone number of the user",
            "example": "+14155552671"
          },
          "phoneCountry": {
            "type": "string",
            "description": "The ISO country code for the phone number",
            "example": "US"
          },
          "profilePictureUrl": {
            "type": "string",
            "description": "URL to the user profile picture",
            "example": "https://cdn.example.com/avatars/user-123.jpg"
          },
          "locale": {
            "type": "string",
            "description": "The locale/language preference of the user",
            "example": "en-US"
          },
          "timezone": {
            "type": "string",
            "description": "The timezone preference of the user",
            "example": "America/New_York"
          },
          "accountStatus": {
            "type": "string",
            "description": "The current account status of the user",
            "example": "ACTIVE",
            "enum": [
              "PENDING_VERIFICATION",
              "ACTIVE",
              "INACTIVE"
            ]
          },
          "emailVerified": {
            "type": "boolean",
            "description": "Whether the user email has been verified",
            "example": true
          },
          "phoneVerified": {
            "type": "boolean",
            "description": "Whether the user phone number has been verified",
            "example": false
          },
          "onboardingStep": {
            "type": "string",
            "description": "The current step in the user onboarding process",
            "example": "COMPLETE",
            "enum": [
              "EMAIL_VERIFICATION",
              "SET_PASSWORD",
              "MOBILE_VERIFICATION",
              "TWO_FACTOR_SETUP",
              "COMPLETE"
            ]
          },
          "passwordHash": {
            "type": "string",
            "description": "The hashed password for direct password updates (use with caution)",
            "example": "$2b$10$..."
          }
        }
      },
      "VerifyIdentityDto": {
        "type": "object",
        "properties": {
          "otpCode": {
            "type": "string",
            "description": "6-digit OTP code sent to current email/phone",
            "example": "123456",
            "minLength": 6,
            "maxLength": 6
          }
        },
        "required": [
          "otpCode"
        ]
      },
      "SubmitNewEmailDto": {
        "type": "object",
        "properties": {
          "changeRequestId": {
            "type": "string",
            "description": "Change request ID from step 2",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "newEmail": {
            "type": "string",
            "description": "New email address",
            "example": "newemail@example.com"
          }
        },
        "required": [
          "changeRequestId",
          "newEmail"
        ]
      },
      "VerifyNewEmailDto": {
        "type": "object",
        "properties": {
          "changeRequestId": {
            "type": "string",
            "description": "Change request ID from step 2",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "otpCode": {
            "type": "string",
            "description": "6-digit OTP code sent to new email",
            "example": "123456",
            "minLength": 6,
            "maxLength": 6
          }
        },
        "required": [
          "changeRequestId",
          "otpCode"
        ]
      },
      "RevertEmailChangeDto": {
        "type": "object",
        "properties": {
          "revertToken": {
            "type": "string",
            "description": "Revert token from email notification",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          }
        },
        "required": [
          "revertToken"
        ]
      },
      "SubmitNewPhoneDto": {
        "type": "object",
        "properties": {
          "changeRequestId": {
            "type": "string",
            "description": "Change request ID from step 2",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "newPhone": {
            "type": "string",
            "description": "New phone number",
            "example": "9876543210"
          },
          "newPhoneCountry": {
            "type": "string",
            "description": "Country code for new phone number",
            "example": "IN"
          }
        },
        "required": [
          "changeRequestId",
          "newPhone",
          "newPhoneCountry"
        ]
      },
      "VerifyNewPhoneDto": {
        "type": "object",
        "properties": {
          "changeRequestId": {
            "type": "string",
            "description": "Change request ID from step 2",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "otpCode": {
            "type": "string",
            "description": "6-digit OTP code sent to new phone",
            "example": "123456",
            "minLength": 6,
            "maxLength": 6
          }
        },
        "required": [
          "changeRequestId",
          "otpCode"
        ]
      },
      "RevertPhoneChangeDto": {
        "type": "object",
        "properties": {
          "revertToken": {
            "type": "string",
            "description": "Revert token from notification",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          }
        },
        "required": [
          "revertToken"
        ]
      },
      "SignupDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "description": "User email address",
            "example": "user@example.com",
            "format": "email"
          },
          "password": {
            "type": "string",
            "description": "Password (min 8 chars, must include uppercase, lowercase, number, and special character)",
            "example": "SecureP@ss123",
            "minLength": 8
          },
          "fullName": {
            "type": "string",
            "description": "User full name",
            "example": "John Doe"
          }
        },
        "required": [
          "email",
          "password",
          "fullName"
        ]
      },
      "TokenResponse": {
        "type": "object",
        "properties": {
          "accessToken": {
            "type": "string",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          },
          "expiresIn": {
            "type": "number",
            "example": 3600
          }
        },
        "required": [
          "accessToken",
          "expiresIn"
        ]
      },
      "LoginDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "description": "User email address",
            "example": "user@example.com",
            "format": "email"
          },
          "password": {
            "type": "string",
            "description": "User password",
            "example": "SecureP@ss123",
            "minLength": 8
          }
        },
        "required": [
          "email",
          "password"
        ]
      },
      "MfaChallengeInfo": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "MFA session ID",
            "example": "mfa_abc123xyz"
          },
          "availableMethods": {
            "type": "array",
            "description": "Available MFA methods",
            "example": [
              "totp",
              "sms"
            ],
            "items": {
              "type": "string",
              "enum": [
                "totp",
                "sms",
                "passkey"
              ]
            }
          },
          "defaultMethod": {
            "type": "string",
            "description": "Default MFA method",
            "example": "totp",
            "enum": [
              "totp",
              "sms",
              "passkey"
            ]
          },
          "maskedPhone": {
            "type": "string",
            "description": "Masked phone number for SMS verification",
            "example": "+1 *** *** 4567"
          }
        },
        "required": [
          "sessionId",
          "availableMethods",
          "defaultMethod"
        ]
      },
      "LoginResponse": {
        "type": "object",
        "properties": {
          "accessToken": {
            "type": "string",
            "description": "JWT access token",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          },
          "expiresIn": {
            "type": "number",
            "description": "Access token expiry in seconds",
            "example": 3600
          },
          "user": {
            "type": "object",
            "description": "User information"
          },
          "requiresMfa": {
            "type": "boolean",
            "description": "Whether MFA verification is required",
            "example": true
          },
          "mfaChallenge": {
            "description": "MFA challenge information",
            "allOf": [
              {
                "$ref": "#/components/schemas/MfaChallengeInfo"
              }
            ]
          }
        }
      },
      "AuthStatusResponse": {
        "type": "object",
        "properties": {
          "isAuthenticated": {
            "type": "boolean",
            "description": "Whether the user is authenticated",
            "example": true
          },
          "user": {
            "description": "User information (only present when authenticated)",
            "allOf": [
              {
                "$ref": "#/components/schemas/UserDto"
              }
            ]
          },
          "accessToken": {
            "type": "string",
            "description": "JWT access token (only present when authenticated)",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          },
          "expiresIn": {
            "type": "number",
            "description": "Token expiry in seconds (only present when authenticated)",
            "example": 3600
          },
          "requiresOnboarding": {
            "type": "boolean",
            "description": "Whether the user needs to complete onboarding",
            "example": false
          }
        },
        "required": [
          "isAuthenticated"
        ]
      },
      "MessageResponse": {
        "type": "object",
        "properties": {
          "message": {
            "type": "string",
            "example": "Operation completed successfully"
          }
        },
        "required": [
          "message"
        ]
      },
      "SessionResponse": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "Unique session identifier",
            "example": "550e8400-e29b-41d4-a716-446655440000"
          },
          "device": {
            "type": "string",
            "description": "Device information parsed from user agent",
            "example": "Chrome on macOS"
          },
          "location": {
            "type": "string",
            "description": "Geographic location based on IP address",
            "example": "San Francisco, CA"
          },
          "ipAddress": {
            "type": "string",
            "description": "IP address of the session",
            "example": "192.168.1.1"
          },
          "lastActive": {
            "format": "date-time",
            "type": "string",
            "description": "Last activity timestamp",
            "example": "2026-02-04T12:30:00Z"
          },
          "isCurrent": {
            "type": "boolean",
            "description": "Whether this is the current session",
            "example": false
          }
        },
        "required": [
          "sessionId",
          "device",
          "location",
          "ipAddress",
          "lastActive",
          "isCurrent"
        ]
      },
      "ChangePasswordDto": {
        "type": "object",
        "properties": {
          "currentPassword": {
            "type": "string",
            "description": "Current password for verification",
            "example": "MyOldPassword123!"
          },
          "newPassword": {
            "type": "string",
            "description": "New password (min 8 chars, must contain uppercase, lowercase, number, and special character)",
            "example": "MyNewPassword456!"
          }
        },
        "required": [
          "currentPassword",
          "newPassword"
        ]
      },
      "ForgotPasswordDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "description": "User email address",
            "example": "user@example.com",
            "format": "email"
          }
        },
        "required": [
          "email"
        ]
      },
      "ForgotPasswordResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "message": {
            "type": "string"
          },
          "accessToken": {
            "type": "string"
          },
          "expiresIn": {
            "type": "number"
          }
        },
        "required": [
          "success",
          "message"
        ]
      },
      "SuccessResponse": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "example": true
          },
          "message": {
            "type": "string",
            "example": "Operation completed successfully"
          }
        },
        "required": [
          "success",
          "message"
        ]
      },
      "VerifyResetOtpDto": {
        "type": "object",
        "properties": {
          "otp": {
            "type": "string",
            "description": "6 digit OTP sent to the user email",
            "example": "123456"
          }
        },
        "required": [
          "otp"
        ]
      },
      "ResetPasswordDto": {
        "type": "object",
        "properties": {
          "newPassword": {
            "type": "string",
            "description": "New password (min 8 chars, must include uppercase, lowercase, number, and special character)",
            "example": "NewPassword123!",
            "minLength": 8
          }
        },
        "required": [
          "newPassword"
        ]
      },
      "ResetPasswordResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean"
          },
          "message": {
            "type": "string"
          },
          "accessToken": {
            "type": "string"
          },
          "expiresIn": {
            "type": "number"
          },
          "sessionType": {
            "type": "string"
          }
        },
        "required": [
          "success",
          "message",
          "accessToken",
          "expiresIn",
          "sessionType"
        ]
      },
      "StartPasskeyAuthDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "description": "User email address to identify which passkey credentials to allow. If not provided, all registered passkeys for discoverable credentials will be allowed",
            "example": "user@example.com",
            "format": "email"
          }
        }
      },
      "VerifyPasskeyAuthDto": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "Session identifier from the passkey authentication options request",
            "example": "sess_abc123def456ghi789"
          },
          "credential": {
            "type": "object",
            "description": "WebAuthn authentication response containing the signed challenge and credential data",
            "example": {
              "id": "Y3JlZGVudGlhbC1pZC1iYXNlNjQ",
              "rawId": "Y3JlZGVudGlhbC1pZC1iYXNlNjQ",
              "response": {
                "clientDataJSON": "eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiZEdWemRDMWphR0ZzYkdWdVoyVXRZbUZ6WlRZMCIsIm9yaWdpbiI6Imh0dHBzOi8vZXhhbXBsZS5jb20ifQ",
                "authenticatorData": "SZYN5YgOjGh0NBcPZHZgW4_krrmihjLHmVzzuoMdl2MFAAAAAQ",
                "signature": "MEUCIQDKoFZ_Bz2nY3T0S7vM6XJ9nKXJTjK2wZ1vW9sC8nA3TAIgX5aK9pM7sQ3rT2vN6wK8jF4hL1bC0mD9eY3xZ2oA1sU",
                "userHandle": "dXNlcl8xMjM0NTY3ODkw"
              },
              "authenticatorAttachment": "platform",
              "clientExtensionResults": {},
              "type": "public-key"
            }
          }
        },
        "required": [
          "sessionId",
          "credential"
        ]
      },
      "VerifyMfaTotpDto": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "MFA session identifier obtained from the login challenge response",
            "example": "f47ac10b-58cc-4372-a567-0e02b2c3d479"
          },
          "code": {
            "type": "string",
            "description": "Six-digit TOTP code from the authenticator app (e.g., Google Authenticator, Authy)",
            "example": "123456",
            "minLength": 6,
            "maxLength": 6,
            "pattern": "^\\d{6}$"
          }
        },
        "required": [
          "sessionId",
          "code"
        ]
      },
      "MfaVerificationUserDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the user",
            "example": "usr_abc123def456"
          },
          "email": {
            "type": "string",
            "description": "Email address of the authenticated user",
            "example": "user@example.com"
          },
          "fullName": {
            "type": "string",
            "description": "Full name of the user",
            "example": "John Doe"
          },
          "displayName": {
            "type": "string",
            "description": "Display name of the user",
            "example": "John"
          }
        },
        "required": [
          "id",
          "email",
          "fullName",
          "displayName"
        ]
      },
      "MfaVerificationResponseDto": {
        "type": "object",
        "properties": {
          "accessToken": {
            "type": "string",
            "description": "JWT access token for authenticating subsequent API requests",
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
          },
          "expiresIn": {
            "type": "number",
            "description": "Token expiration time in seconds",
            "example": 3600
          },
          "user": {
            "description": "Information about the authenticated user",
            "allOf": [
              {
                "$ref": "#/components/schemas/MfaVerificationUserDto"
              }
            ]
          }
        },
        "required": [
          "accessToken",
          "expiresIn",
          "user"
        ]
      },
      "SendSmsOtpDto": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "MFA session identifier obtained from the login challenge response",
            "example": "f47ac10b-58cc-4372-a567-0e02b2c3d479"
          }
        },
        "required": [
          "sessionId"
        ]
      },
      "SmsOtpSentResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the SMS OTP was sent successfully",
            "example": true
          },
          "message": {
            "type": "string",
            "description": "Human-readable message about the SMS OTP status",
            "example": "Verification code sent successfully"
          },
          "maskedPhone": {
            "type": "string",
            "description": "Masked phone number where the OTP was sent",
            "example": "+1******7890"
          }
        },
        "required": [
          "success",
          "message",
          "maskedPhone"
        ]
      },
      "VerifySmsOtpDto": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "MFA session identifier obtained from the login challenge response",
            "example": "f47ac10b-58cc-4372-a567-0e02b2c3d479"
          },
          "code": {
            "type": "string",
            "description": "Six-digit verification code received via SMS",
            "example": "123456",
            "minLength": 6,
            "maxLength": 6,
            "pattern": "^\\d{6}$"
          }
        },
        "required": [
          "sessionId",
          "code"
        ]
      },
      "StartPasskeyMfaDto": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "MFA session identifier obtained from the login challenge response",
            "example": "f47ac10b-58cc-4372-a567-0e02b2c3d479"
          }
        },
        "required": [
          "sessionId"
        ]
      },
      "PasskeyMfaOptionsDto": {
        "type": "object",
        "properties": {
          "options": {
            "type": "object",
            "description": "WebAuthn authentication options to be passed to the browser credentials API (navigator.credentials.get)",
            "example": {
              "challenge": "base64-encoded-challenge-string",
              "timeout": 60000,
              "rpId": "example.com",
              "allowCredentials": [
                {
                  "type": "public-key",
                  "id": "base64-encoded-credential-id"
                }
              ],
              "userVerification": "preferred"
            }
          }
        },
        "required": [
          "options"
        ]
      },
      "AuthenticatorResponseDto": {
        "type": "object",
        "properties": {
          "clientDataJSON": {
            "type": "string",
            "description": "Base64URL-encoded client data JSON containing challenge and origin",
            "example": "eyJ0eXBlIjoid2ViYXV0aG4uZ2V0IiwiY2hhbGxlbmdlIjoiYWJjMTIzIiwib3JpZ2luIjoiaHR0cHM6Ly9leGFtcGxlLmNvbSJ9"
          },
          "authenticatorData": {
            "type": "string",
            "description": "Base64URL-encoded authenticator data containing flags and counter",
            "example": "SZYN5YgOjGh0NBcPZHZgW4_krrmihjLHmVzzuoMdl2MFAAAAAQ"
          },
          "signature": {
            "type": "string",
            "description": "Base64URL-encoded signature over the client data and authenticator data",
            "example": "MEUCIQDKg5kp3..."
          },
          "userHandle": {
            "type": "string",
            "description": "Base64URL-encoded user handle (user ID)",
            "example": "dXNlcl9hYmMxMjM"
          }
        },
        "required": [
          "clientDataJSON",
          "authenticatorData",
          "signature"
        ]
      },
      "AuthenticationResponseJSONDto": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "Base64URL-encoded credential identifier",
            "example": "pbK2nMnR2..."
          },
          "rawId": {
            "type": "string",
            "description": "Raw credential ID in Base64URL format (same as id)",
            "example": "pbK2nMnR2..."
          },
          "response": {
            "description": "Authenticator response containing the cryptographic proof",
            "allOf": [
              {
                "$ref": "#/components/schemas/AuthenticatorResponseDto"
              }
            ]
          },
          "authenticatorAttachment": {
            "type": "string",
            "description": "Type of authenticator attachment used",
            "example": "platform",
            "enum": [
              "platform",
              "cross-platform"
            ]
          },
          "clientExtensionResults": {
            "type": "object",
            "description": "Results from client-side WebAuthn extensions",
            "example": {}
          },
          "type": {
            "type": "string",
            "description": "Credential type (always \"public-key\" for WebAuthn)",
            "example": "public-key",
            "enum": [
              "public-key"
            ]
          }
        },
        "required": [
          "id",
          "rawId",
          "response",
          "clientExtensionResults",
          "type"
        ]
      },
      "VerifyPasskeyMfaDto": {
        "type": "object",
        "properties": {
          "sessionId": {
            "type": "string",
            "description": "MFA session identifier obtained from the login challenge response",
            "example": "f47ac10b-58cc-4372-a567-0e02b2c3d479"
          },
          "credential": {
            "description": "WebAuthn authentication response from navigator.credentials.get()",
            "allOf": [
              {
                "$ref": "#/components/schemas/AuthenticationResponseJSONDto"
              }
            ]
          }
        },
        "required": [
          "sessionId",
          "credential"
        ]
      },
      "SetPasswordDto": {
        "type": "object",
        "properties": {
          "password": {
            "type": "string",
            "description": "User password that must be at least 8 characters and contain at least one lowercase letter, uppercase letter, number, and special character",
            "example": "SecureP@ss123",
            "minLength": 8
          }
        },
        "required": [
          "password"
        ]
      },
      "StartOnboardingResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the onboarding start request was successful",
            "example": true
          },
          "message": {
            "type": "string",
            "description": "Human-readable message describing the result of the operation",
            "example": "Onboarding started successfully. OTP sent to your email."
          }
        },
        "required": [
          "success",
          "message"
        ]
      },
      "ResendEmailOtpResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the OTP was resent successfully",
            "example": true
          },
          "message": {
            "type": "string",
            "description": "Confirmation message",
            "example": "OTP sent successfully"
          }
        },
        "required": [
          "success",
          "message"
        ]
      },
      "VerifyEmailDto": {
        "type": "object",
        "properties": {
          "otp": {
            "type": "string",
            "description": "Six-digit one-time password sent to the user email address for verification",
            "example": "123456",
            "minLength": 6,
            "maxLength": 6
          }
        },
        "required": [
          "otp"
        ]
      },
      "VerifyEmailResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the email was verified successfully",
            "example": true
          },
          "message": {
            "type": "string",
            "description": "Confirmation message",
            "example": "Email verified successfully"
          }
        },
        "required": [
          "success",
          "message"
        ]
      },
      "ChangeEmailDto": {
        "type": "object",
        "properties": {
          "email": {
            "type": "string",
            "example": "new@example.com"
          }
        },
        "required": [
          "email"
        ]
      },
      "InitiateMobileVerificationDto": {
        "type": "object",
        "properties": {
          "phone": {
            "type": "string",
            "description": "Phone number in E.164 format (with + prefix).",
            "example": "+919876543210",
            "minLength": 10,
            "maxLength": 20
          },
          "phoneCountry": {
            "type": "string",
            "description": "ISO 3166-1 alpha-2 country code for the phone number",
            "example": "IN",
            "minLength": 2,
            "maxLength": 5
          },
          "method": {
            "type": "string",
            "description": "Method to use for mobile verification.",
            "example": "whatsapp",
            "enum": [
              "whatsapp",
              "sms",
              "manual"
            ]
          }
        },
        "required": [
          "phone",
          "phoneCountry",
          "method"
        ]
      },
      "MobileVerificationStatusResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the verification was initiated successfully",
            "example": true
          },
          "message": {
            "type": "string",
            "description": "Human-readable message describing the verification status",
            "example": "Verification initiated successfully"
          },
          "verificationCode": {
            "type": "string",
            "description": "Verification code for QR-based methods (WhatsApp/SMS). User sends this code to complete verification. Not returned for manual OTP method.",
            "example": "VRFY-A1B2C3"
          },
          "whatsappNumber": {
            "type": "string",
            "description": "WhatsApp business number for generating QR code. Only returned for WhatsApp verification method.",
            "example": "+14155238886"
          }
        },
        "required": [
          "success",
          "message"
        ]
      },
      "VerifyMobileOtpDto": {
        "type": "object",
        "properties": {
          "otp": {
            "type": "string",
            "description": "Six-digit one-time password received via SMS for mobile verification",
            "example": "123456",
            "minLength": 6,
            "maxLength": 6
          }
        },
        "required": [
          "otp"
        ]
      },
      "TotpSetupResponseDto": {
        "type": "object",
        "properties": {
          "keyUri": {
            "type": "string",
            "description": "otpauth:// URI for rendering a QR code on the frontend",
            "example": "otpauth://totp/Vritti:user@example.com?secret=JBSWY3DPEHPK3PXP&issuer=Vritti"
          },
          "manualSetupKey": {
            "type": "string",
            "description": "Manual setup key for users who cannot scan the QR code, to be entered manually in authenticator app",
            "example": "JBSWY3DPEHPK3PXP"
          },
          "issuer": {
            "type": "string",
            "description": "Name of the service/application issuing the TOTP",
            "example": "Vritti"
          },
          "accountName": {
            "type": "string",
            "description": "Account identifier displayed in the authenticator app, typically the user email",
            "example": "john.doe@example.com"
          }
        },
        "required": [
          "keyUri",
          "manualSetupKey",
          "issuer",
          "accountName"
        ]
      },
      "VerifyTotpDto": {
        "type": "object",
        "properties": {
          "code": {
            "type": "string",
            "description": "Six-digit TOTP verification code from the authenticator app",
            "example": "123456",
            "minLength": 6,
            "maxLength": 6
          }
        },
        "required": [
          "code"
        ]
      },
      "BackupCodesResponseDto": {
        "type": "object",
        "properties": {
          "success": {
            "type": "boolean",
            "description": "Indicates whether the backup codes were generated successfully",
            "example": true
          },
          "message": {
            "type": "string",
            "description": "Human-readable message describing the result of the operation",
            "example": "Backup codes generated successfully. Store them securely."
          },
          "backupCodes": {
            "description": "Array of one-time use backup codes for account recovery",
            "example": [
              "ABC123DE",
              "FGH456IJ",
              "KLM789NO",
              "PQR012ST",
              "UVW345XY",
              "ZAB678CD",
              "EFG901HI",
              "JKL234MN"
            ],
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "warning": {
            "type": "string",
            "description": "Important warning message about storing backup codes securely",
            "example": "These codes will only be shown once. Store them in a secure location. Each code can only be used once."
          }
        },
        "required": [
          "success",
          "message",
          "backupCodes",
          "warning"
        ]
      },
      "PasskeyRegistrationOptionsDto": {
        "type": "object",
        "properties": {
          "options": {
            "type": "object",
            "description": "WebAuthn PublicKeyCredentialCreationOptions object containing challenge, relying party info, user info, and supported algorithms for passkey registration",
            "example": {
              "challenge": "base64url-encoded-challenge",
              "rp": {
                "name": "Vritti",
                "id": "vritti.com"
              },
              "user": {
                "id": "base64url-user-id",
                "name": "john.doe@example.com",
                "displayName": "John Doe"
              },
              "pubKeyCredParams": [
                {
                  "type": "public-key",
                  "alg": -7
                }
              ],
              "timeout": 60000,
              "attestation": "none",
              "authenticatorSelection": {
                "authenticatorAttachment": "platform",
                "requireResidentKey": false,
                "userVerification": "preferred"
              }
            }
          }
        },
        "required": [
          "options"
        ]
      },
      "VerifyPasskeyDto": {
        "type": "object",
        "properties": {
          "credential": {
            "type": "object",
            "description": "WebAuthn credential registration response from the browser containing attestation data",
            "example": {
              "id": "base64url-credential-id",
              "rawId": "base64url-raw-credential-id",
              "response": {
                "clientDataJSON": "base64url-client-data",
                "attestationObject": "base64url-attestation-object",
                "transports": [
                  "internal",
                  "hybrid"
                ]
              },
              "authenticatorAttachment": "platform",
              "clientExtensionResults": {},
              "type": "public-key"
            }
          }
        },
        "required": [
          "credential"
        ]
      },
      "MfaStatusResponseDto": {
        "type": "object",
        "properties": {
          "isEnabled": {
            "type": "boolean",
            "description": "Indicates whether multi-factor authentication is enabled for the user",
            "example": true
          },
          "method": {
            "type": "string",
            "description": "The multi-factor authentication method configured by the user",
            "example": "TOTP",
            "enum": [
              "TOTP",
              "PASSKEY",
              "SMS",
              "EMAIL"
            ],
            "nullable": true
          },
          "backupCodesRemaining": {
            "type": "number",
            "description": "Number of unused backup codes remaining for account recovery",
            "example": 8
          },
          "lastUsedAt": {
            "type": "string",
            "description": "Timestamp when multi-factor authentication was last used",
            "example": "2024-01-15T10:30:00.000Z",
            "format": "date-time",
            "nullable": true
          },
          "createdAt": {
            "type": "string",
            "description": "Timestamp when multi-factor authentication was initially configured",
            "example": "2024-01-01T08:00:00.000Z",
            "format": "date-time",
            "nullable": true
          }
        },
        "required": [
          "isEnabled",
          "backupCodesRemaining"
        ]
      }
    }
  }
}